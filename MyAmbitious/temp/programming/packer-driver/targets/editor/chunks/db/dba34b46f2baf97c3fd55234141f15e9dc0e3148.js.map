{"version":3,"sources":["file:///C:/Users/%E8%BE%9B%E9%B9%8F/Desktop/CCS/AmbitiousApp/Ambitious/assets/scripts/GetPropenty/StartGet.ts"],"names":["_decorator","Component","director","Input","Vec3","ccclass","property","Start","_IsDargging","touchOffset","onLoad","addTouch","onDestroy","console","log","removeTouch","start","update","deltaTime","node","on","EventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","off","event","touchLocation","getUILocation","x","y","nodeLocation","getPosition","newPosition","setPosition","onback","loadScene"],"mappings":";;;;;;;;;;AACEA,MAAAA,U,OAAAA,U;AACAC,MAAAA,S,OAAAA,S;AAEAC,MAAAA,Q,OAAAA,Q;AAEAC,MAAAA,K,OAAAA,K;AAKAC,MAAAA,I,OAAAA,I;;;;;;;;;OAGI;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;uBAGjBO,K,WADZF,OAAO,CAAC,UAAD,C,gBAAR,MACaE,KADb,SAC2BN,SAD3B,CACqC;AAAA;AAAA;AAAA,eAC3BO,WAD2B,GACJ,KADI;AAAA,eAE3BC,WAF2B,GAEP,IAAIL,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAFO;AAAA;;AAEY;AAE/CM,QAAAA,MAAM,GAAG;AACP,eAAKC,QAAL;AACD;;AAESC,QAAAA,SAAS,GAAS;AAC1BC,UAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ;AACA,eAAKC,WAAL;AACA,eAAKP,WAAL,GAAmB,KAAnB;AACD;;AAEDQ,QAAAA,KAAK,GAAG,CAAE;;AAEVC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAAE,CAhBO,CAkBnC;;;AACAP,QAAAA,QAAQ,GAAG;AACT,eAAKQ,IAAL,CAAUC,EAAV,CAAajB,KAAK,CAACkB,SAAN,CAAgBC,WAA7B,EAA0C,KAAKC,YAA/C,EAA6D,IAA7D;AACA,eAAKJ,IAAL,CAAUC,EAAV,CAAajB,KAAK,CAACkB,SAAN,CAAgBG,UAA7B,EAAyC,KAAKC,WAA9C,EAA2D,IAA3D;AACA,eAAKN,IAAL,CAAUC,EAAV,CAAajB,KAAK,CAACkB,SAAN,CAAgBK,SAA7B,EAAwC,KAAKC,UAA7C,EAAyD,IAAzD;AACA,eAAKR,IAAL,CAAUC,EAAV,CAAajB,KAAK,CAACkB,SAAN,CAAgBO,YAA7B,EAA2C,KAAKD,UAAhD,EAA4D,IAA5D;AACD,SAxBkC,CA0BnC;;;AACAZ,QAAAA,WAAW,GAAG;AACZ,eAAKI,IAAL,CAAUU,GAAV,CAAc1B,KAAK,CAACkB,SAAN,CAAgBC,WAA9B,EAA2C,KAAKC,YAAhD,EAA8D,IAA9D;AACA,eAAKJ,IAAL,CAAUU,GAAV,CAAc1B,KAAK,CAACkB,SAAN,CAAgBG,UAA9B,EAA0C,KAAKC,WAA/C,EAA4D,IAA5D;AACA,eAAKN,IAAL,CAAUU,GAAV,CAAc1B,KAAK,CAACkB,SAAN,CAAgBK,SAA9B,EAAyC,KAAKC,UAA9C,EAA0D,IAA1D;AACA,eAAKR,IAAL,CAAUU,GAAV,CAAc1B,KAAK,CAACkB,SAAN,CAAgBO,YAA9B,EAA4C,KAAKD,UAAjD,EAA6D,IAA7D;AACD,SAhCkC,CAkCnC;;;AACAJ,QAAAA,YAAY,CAACO,KAAD,EAAoB;AAC9B,gBAAMC,aAAa,GAAGD,KAAK,CAACE,aAAN,EAAtB,CAD8B,CACe;;AAC7CnB,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAUiB,aAAa,CAACE,CAApC;AACApB,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAUiB,aAAa,CAACG,CAApC;AACA,gBAAMC,YAAY,GAAG,KAAKhB,IAAL,CAAUiB,WAAV,EAArB,CAJ8B,CAIgB;;AAC9CvB,UAAAA,OAAO,CAACC,GAAR,CAAY,SAASqB,YAAY,CAACF,CAAlC;AACApB,UAAAA,OAAO,CAACC,GAAR,CAAY,SAASqB,YAAY,CAACD,CAAlC,EAN8B,CAO9B;;AAEA,eAAKzB,WAAL,CAAiBwB,CAAjB,GAAqBF,aAAa,CAACE,CAAd,GAAkBE,YAAY,CAACF,CAApD;AACA,eAAKxB,WAAL,CAAiByB,CAAjB,GAAqBH,aAAa,CAACG,CAAd,GAAkBC,YAAY,CAACD,CAApD;AACArB,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAU,KAAKL,WAAL,CAAiBwB,CAAvC;AACApB,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAU,KAAKL,WAAL,CAAiByB,CAAvC;AACA,eAAK1B,WAAL,GAAmB,IAAnB,CAb8B,CAc9B;;AACA;AACD,SAnDkC,CAqDnC;;;AACAiB,QAAAA,WAAW,CAACK,KAAD,EAAoB;AAC7B,cAAI,CAAC,KAAKtB,WAAV,EAAuB;AACvB,gBAAMuB,aAAa,GAAGD,KAAK,CAACE,aAAN,EAAtB;AACA,cAAIK,WAAW,GAAG,IAAIjC,IAAJ,CAChB2B,aAAa,CAACE,CAAd,GAAkB,KAAKxB,WAAL,CAAiBwB,CADnB,EAEhBF,aAAa,CAACG,CAAd,GAAkB,KAAKzB,WAAL,CAAiByB,CAFnB,EAGhB,CAHgB,CAAlB,CAH6B,CAQ7B;AACA;;AACA,eAAKf,IAAL,CAAUmB,WAAV,CAAsBD,WAAtB;AACD;;AACDV,QAAAA,UAAU,GAAG;AACXd,UAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EADW,CAEX;AACD;;AACDyB,QAAAA,MAAM,GAAG;AACPrC,UAAAA,QAAQ,CAACsC,SAAT,CAAmB,sBAAnB;AACD;;AAxEkC,O","sourcesContent":["import {\r\n  _decorator,\r\n  Component,\r\n  computeRatioByType,\r\n  director,\r\n  EventTouch,\r\n  Input,\r\n  input,\r\n  Node,\r\n  Prefab,\r\n  Scene,\r\n  Vec3,\r\n} from \"cc\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"StartGet\")\r\nexport class Start extends Component {\r\n  private _IsDargging: boolean = false;\r\n  private touchOffset: Vec3 = new Vec3(0, 0, 0); // 跟踪触摸偏移量\r\n\r\n  onLoad() {\r\n    this.addTouch();\r\n  }\r\n\r\n  protected onDestroy(): void {\r\n    console.log(\"移除\");\r\n    this.removeTouch();\r\n    this._IsDargging = false;\r\n  }\r\n\r\n  start() {}\r\n\r\n  update(deltaTime: number) {}\r\n\r\n  // 添加触摸事件监听\r\n  addTouch() {\r\n    this.node.on(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n    this.node.on(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n    this.node.on(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    this.node.on(Input.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n  }\r\n\r\n  // 移除触摸事件监听\r\n  removeTouch() {\r\n    this.node.off(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n    this.node.off(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n    this.node.off(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    this.node.off(Input.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n  }\r\n\r\n  // 在触摸开始时，计算并存储初始的偏移量\r\n  onTouchStart(event: EventTouch) {\r\n    const touchLocation = event.getUILocation(); // 获取触摸点的位置\r\n    console.log(\"触摸点X:\" + touchLocation.x);\r\n    console.log(\"触摸点Y:\" + touchLocation.y);\r\n    const nodeLocation = this.node.getPosition(); // 获取节点的位置\r\n    console.log(\"节点X:\" + nodeLocation.x);\r\n    console.log(\"节点Y:\" + nodeLocation.y);\r\n    // 计算触摸点和节点位置的偏移量\r\n\r\n    this.touchOffset.x = touchLocation.x - nodeLocation.x;\r\n    this.touchOffset.y = touchLocation.y - nodeLocation.y;\r\n    console.log(\"偏移量X:\" + this.touchOffset.x);\r\n    console.log(\"偏移量Y:\" + this.touchOffset.y);\r\n    this._IsDargging = true;\r\n    ///*console.log(`触摸开始位置: x=${touchLocation.x}, y=${touchLocation.y}`)*/;*/\r\n    /*console.log(`节点初始位置: x=${nodeLocation.x}, y=${nodeLocation.y}`);*/\r\n  }\r\n\r\n  // 在触摸移动时，更新节点的位置\r\n  onTouchMove(event: EventTouch) {\r\n    if (!this._IsDargging) return;\r\n    const touchLocation = event.getUILocation();\r\n    let newPosition = new Vec3(\r\n      touchLocation.x - this.touchOffset.x,\r\n      touchLocation.y - this.touchOffset.y,\r\n      0\r\n    );\r\n    // 限定拖动范围\r\n    // newPosition = this.clampPosition(newPosition);\r\n    this.node.setPosition(newPosition);\r\n  }\r\n  onTouchEnd() {\r\n    console.log(\"触摸结束\");\r\n    // 可选：重置变量或执行其他操作\r\n  }\r\n  onback() {\r\n    director.loadScene(\"WarehouseScene(仓库页面)\");\r\n  }\r\n}\r\n"]}