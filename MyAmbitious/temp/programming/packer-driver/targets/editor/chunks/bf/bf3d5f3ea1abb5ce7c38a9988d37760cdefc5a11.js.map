{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Ambitious/assets/scripts/GetPropenty/StartGet.ts"],"names":["_decorator","Component","director","Input","Vec3","ccclass","property","Start","_IsDargging","touchOffset","onLoad","addTouch","onDestroy","console","log","removeTouch","update","deltaTime","node","on","EventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","off","event","touchLocation","getUILocation","nodeLocation","getPosition","x","y","newPosition","clampPosition","setPosition","maxX","maxY","minx","miny","Math","min","max","z","onback","loadScene"],"mappings":"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","sourcesContent":["import {\r\n  _decorator,\r\n  Collider2D,\r\n  Component,\r\n  computeRatioByType,\r\n  Contact2DType,\r\n  director,\r\n  EventTouch,\r\n  Input,\r\n  input,\r\n  Node,\r\n  Prefab,\r\n  Scene,\r\n  Vec3,\r\n} from \"cc\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"StartGet\")\r\nexport class Start extends Component {\r\n  private _IsDargging: boolean = false;\r\n  private touchOffset: Vec3 = new Vec3(0, 0, 0); // 跟踪触摸偏移量\r\n\r\n  onLoad() {\r\n    this.addTouch();\r\n  }\r\n\r\n  protected onDestroy(): void {\r\n    console.log(\"移除\");\r\n    this.removeTouch();\r\n    this._IsDargging = false;\r\n  }\r\n  update(deltaTime: number) {}\r\n\r\n  // 添加触摸事件监听\r\n  addTouch() {\r\n    this.node.on(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n    this.node.on(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n    this.node.on(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    this.node.on(Input.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n  }\r\n\r\n  // 移除触摸事件监听\r\n  removeTouch() {\r\n    this.node.off(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n    this.node.off(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n    this.node.off(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    this.node.off(Input.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n  }\r\n\r\n  // 在触摸开始时，计算并存储初始的偏移量\r\n  onTouchStart(event: EventTouch) {\r\n    const touchLocation = event.getUILocation();\r\n    const nodeLocation = this.node.getPosition();\r\n    this.touchOffset.x = touchLocation.x - nodeLocation.x;\r\n    this.touchOffset.y = touchLocation.y - nodeLocation.y;\r\n    this._IsDargging = true;\r\n  }\r\n\r\n  // 在触摸移动时，更新节点的位置\r\n  onTouchMove(event: EventTouch) {\r\n    if (!this._IsDargging) return;\r\n    const touchLocation = event.getUILocation();\r\n    let newPosition = new Vec3(\r\n      touchLocation.x - this.touchOffset.x,\r\n      touchLocation.y - this.touchOffset.y,\r\n      0\r\n    );\r\n    // 限定拖动范围\r\n    newPosition = this.clampPosition(newPosition);\r\n    this.node.setPosition(newPosition);\r\n  }\r\n  clampPosition(newPosition: Vec3): Vec3 {\r\n    const maxX = 250; // 最大X坐标\r\n    const maxY = 350; // 最大Y坐标\r\n\r\n    const minx = -250;\r\n    const miny = -350;\r\n\r\n    newPosition.x = Math.min(Math.max(newPosition.x, minx), maxX);\r\n    newPosition.y = Math.min(Math.max(newPosition.y, miny), maxY); // 修正为 miny\r\n    newPosition.z = 0; // 确保Z坐标为0\r\n    return newPosition;\r\n  }\r\n  onTouchEnd() {\r\n    console.log(\"触摸结束\");\r\n    // 可选：重置变量或执行其他操作\r\n  }\r\n  onback() {\r\n    director.loadScene(\"WarehouseScene(仓库页面)\");\r\n  }\r\n}\r\n"]}