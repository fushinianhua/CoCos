{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Ambitious/assets/scripts/GetPropenty/Move.ts"],"names":["_decorator","Component","instantiate","Node","Prefab","tween","Vec2","Vec3","ccclass","property","Move","_offset","_isDragging","onLoad","addTouch","start","scheduleOnce","removeTouch","FutureWorkLabel","setParent","node","t1","to","position","easing","t2","call","restratpanel","active","onDestroy","onTouchStart","event","touchLocation","getUILocation","nodeLocation","getPosition","set","x","y","onTouchMove","newPosition","z","clampPosition","setPosition","onTouchEnd","clampedX","Math","max","minBoundary","min","maxBoundary","clampedY","on","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","TOUCH_CANCEL","off"],"mappings":"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","sourcesContent":["import {\r\n  _decorator,\r\n  Component,\r\n  EventTouch,\r\n  instantiate,\r\n  Node,\r\n  Prefab,\r\n  tween,\r\n  Vec2,\r\n  Vec3,\r\n} from \"cc\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"Move\")\r\nexport class Move extends Component {\r\n  @property(Vec2)\r\n  public minBoundary: Vec2 = new Vec2(0, 0);\r\n  @property(Vec2)\r\n  public maxBoundary: Vec2 = new Vec2(0, 0);\r\n  @property(Prefab)\r\n  FutureWorkLabel: Prefab = null;\r\n  private _offset: Vec3 = new Vec3();\r\n  private _isDragging: boolean = false;\r\n  @property(Node)\r\n  restratpanel: Node = null;\r\n  onLoad() {\r\n    // 注册触摸事件\r\n    this.addTouch();\r\n  }\r\n  protected start(): void {\r\n    this.scheduleOnce(() => {\r\n      // 移除触摸事件\r\n      this.removeTouch();\r\n      // 创建标签并添加到节点上\r\n      let FutureWorkLabel = instantiate(this.FutureWorkLabel);\r\n      // 设置标签的位置\r\n\r\n      FutureWorkLabel.setParent(this.node);\r\n      // 动画效果\r\n      let t1 = tween(FutureWorkLabel).to(\r\n        1.5,\r\n        { position: new Vec3(0, 95, 0) },\r\n        { easing: \"backInOut\" }\r\n      );\r\n      // 移动节点效果\r\n      let t2 = tween(this.node).to(2, { position: new Vec3(0, 170, 0) });\r\n      // 动画结束后执行回调函数，然后开始移动节点的效果\r\n      t1.call(() => {\r\n        t2.start();\r\n        this.restratpanel.active = true;\r\n      }).start();\r\n    }, 8);\r\n  }\r\n  onDestroy() {\r\n    // 移除触摸事件\r\n    this.removeTouch();\r\n  }\r\n  onTouchStart(event: EventTouch) {\r\n    //触摸位置\r\n    const touchLocation = event.getUILocation();\r\n    //结点位置\r\n    const nodeLocation = this.node.getPosition();\r\n    //计算位置偏移量\r\n    this._offset.set(\r\n      touchLocation.x - nodeLocation.x,\r\n      touchLocation.y - nodeLocation.y,\r\n      0\r\n    );\r\n    this._isDragging = true;\r\n  }\r\n\r\n  onTouchMove(event: EventTouch) {\r\n    if (!this._isDragging) return;\r\n    const touchLocation = event.getUILocation();\r\n    let newPosition = new Vec3(\r\n      touchLocation.x - this._offset.x,\r\n      touchLocation.y - this._offset.y,\r\n      this.node.getPosition().z\r\n    );\r\n    // 限定拖动范围\r\n    newPosition = this.clampPosition(newPosition);\r\n    this.node.setPosition(newPosition);\r\n  }\r\n\r\n  onTouchEnd(event: EventTouch) {\r\n    this._isDragging = false;\r\n  }\r\n\r\n  clampPosition(position: Vec3): Vec3 {\r\n    // 将位置x限制在最小边界和最大边界之间\r\n    const clampedX = Math.max(\r\n      this.minBoundary.x,\r\n      Math.min(position.x, this.maxBoundary.x)\r\n    );\r\n    // 将位置y限制在最小边界和最大边界之间\r\n    const clampedY = Math.max(\r\n      this.minBoundary.y,\r\n      Math.min(position.y, this.maxBoundary.y)\r\n    );\r\n    // 返回新的Vec3对象，其中x和y被限制在边界内，z保持不变\r\n    return new Vec3(clampedX, clampedY, position.z);\r\n  }\r\n  addTouch() {\r\n    this.node.on(Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n    this.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n    this.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    this.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n  }\r\n  removeTouch() {\r\n    this.node.off(Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n    this.node.off(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n    this.node.off(Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    this.node.off(Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n  }\r\n}\r\n"]}